@tailwind base;
@tailwind components;
@tailwind utilities;

@layer utilities {
  .text-balance {
    text-wrap: balance;
  }
}

/* 主题定制相关样式 */
@layer components {
  /* 紧凑模式 */
  .compact-mode {
    --spacing-base: 12px;
  }

  .compact-mode .p-4 {
    padding: 0.75rem;
  }

  .compact-mode .p-6 {
    padding: 1rem;
  }

  .compact-mode .gap-4 {
    gap: 0.75rem;
  }

  .compact-mode .gap-6 {
    gap: 1rem;
  }

  /* 禁用动画 */
  .no-animations * {
    transition: none !important;
    animation: none !important;
  }

  /* 修复黑色主题在深色模式下的可见性问题 */
  .dark-black-theme-fix .bg-gradient-to-r.from-primary.to-primary\/70.bg-clip-text.text-transparent {
    background: linear-gradient(to right, hsl(var(--foreground)), hsl(var(--foreground) / 0.7)) !important;
    background-clip: text !important;
    -webkit-background-clip: text !important;
    color: transparent !important;
  }

  .dark-black-theme-fix .bookmark-group:hover .bookmark-group-hover\:text-primary {
    color: hsl(var(--foreground)) !important;
  }

  .dark-black-theme-fix .text-primary {
    color: hsl(var(--foreground)) !important;
  }

  .dark-black-theme-fix .text-primary-foreground {
    color: hsl(var(--background)) !important;
  }

  .dark-black-theme-fix .bg-primary\/5 {
    background-color: hsl(var(--foreground) / 0.05) !important;
  }

  .dark-black-theme-fix .bg-primary\/10 {
    background-color: hsl(var(--foreground) / 0.1) !important;
  }

  .dark-black-theme-fix .border-primary\/30 {
    border-color: hsl(var(--foreground) / 0.3) !important;
  }

  .dark-black-theme-fix .border-primary\/50 {
    border-color: hsl(var(--foreground) / 0.5) !important;
  }

  /* 修复二级分类胶囊标签的选中状态 */
  .dark-black-theme-fix .bg-gradient-to-r.from-primary.to-primary\/80 {
    background: linear-gradient(to right, hsl(var(--foreground)), hsl(var(--foreground) / 0.8)) !important;
  }

  .dark-black-theme-fix .bg-gradient-to-r.from-primary.to-primary\/80.text-primary-foreground {
    color: hsl(var(--background)) !important;
  }

  /* 修复用户点击选中的二级分类标签（enhanced-main-content中的简化样式） */
  .dark-black-theme-fix .bg-primary.text-primary-foreground {
    background: hsl(var(--foreground)) !important;
    color: hsl(var(--background)) !important;
  }

  /* 修复边框颜色 */
  .dark-black-theme-fix .border-primary\/20 {
    border-color: hsl(var(--foreground) / 0.2) !important;
  }

  /* 卡片样式变体 */
  .card-style-minimal .border {
    border-width: 1px;
    border-color: hsl(var(--border) / 0.3);
  }

  .card-style-minimal .shadow-sm {
    box-shadow: none;
  }

  .card-style-glass {
    backdrop-filter: blur(10px);
    background: hsl(var(--card) / 0.8);
  }

  .card-style-shadow .shadow-sm {
    box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
  }

  .card-style-shadow:hover {
    box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
  }

  /* 布局样式 - 只影响书签网格 */
  .layout-list .bookmark-grid {
    display: flex !important;
    flex-direction: column !important;
    gap: 0 !important;
    grid-template-columns: none !important;
  }

  /* 瀑布流布局 - 使用 CSS Grid 实现 */
  .layout-masonry .bookmark-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1rem;
    grid-auto-rows: masonry; /* 现代浏览器支持 */
  }

  /* 为不支持 masonry 的浏览器提供备选方案 */
  @supports not (grid-auto-rows: masonry) {
    .layout-masonry .bookmark-grid {
      columns: 1;
      column-gap: 1rem;
    }

    .layout-masonry .bookmark-grid > * {
      break-inside: avoid;
      margin-bottom: 1rem;
      display: inline-block;
      width: 100%;
    }
  }

  @media (min-width: 768px) {
    .layout-masonry .bookmark-grid {
      grid-template-columns: repeat(2, 1fr);
    }

    @supports not (grid-auto-rows: masonry) {
      .layout-masonry .bookmark-grid {
        columns: 2;
        column-gap: 1.5rem;
      }
    }
  }

  @media (min-width: 1024px) {
    .layout-masonry .bookmark-grid {
      grid-template-columns: repeat(3, 1fr);
    }

    @supports not (grid-auto-rows: masonry) {
      .layout-masonry .bookmark-grid {
        columns: 3;
        column-gap: 1.5rem;
      }
    }
  }

  @media (min-width: 1280px) {
    .layout-masonry .bookmark-grid {
      grid-template-columns: repeat(4, 1fr);
    }

    @supports not (grid-auto-rows: masonry) {
      .layout-masonry .bookmark-grid {
        columns: 4;
        column-gap: 1.5rem;
      }
    }
  }

  /* 网格布局保持原有的 grid 样式，不覆盖动态列数设置 */
  .layout-grid .bookmark-grid {
    display: grid;
    /* 不设置 grid-template-columns，让 DynamicBookmarkGrid 组件控制 */
  }

  /* 瀑布流布局中的书签卡片样式 */
  .layout-masonry .bookmark-card {
    margin-bottom: 0 !important;
  }

  /* 为瀑布流创建不同高度的卡片效果 - 模拟真实的瀑布流 */
  .layout-masonry .bookmark-card:nth-child(6n+1) {
    min-height: 160px;
  }

  .layout-masonry .bookmark-card:nth-child(6n+2) {
    min-height: 120px;
  }

  .layout-masonry .bookmark-card:nth-child(6n+3) {
    min-height: 180px;
  }

  .layout-masonry .bookmark-card:nth-child(6n+4) {
    min-height: 140px;
  }

  .layout-masonry .bookmark-card:nth-child(6n+5) {
    min-height: 200px;
  }

  .layout-masonry .bookmark-card:nth-child(6n+6) {
    min-height: 130px;
  }

  /* 瀑布流中添加一些随机的内容高度 */
  .layout-masonry .bookmark-card:nth-child(6n+1) .card-content::after {
    content: "";
    display: block;
    height: 20px;
  }

  .layout-masonry .bookmark-card:nth-child(6n+3) .card-content::after {
    content: "";
    display: block;
    height: 40px;
  }

  .layout-masonry .bookmark-card:nth-child(6n+5) .card-content::after {
    content: "";
    display: block;
    height: 60px;
  }

  /* 列表布局的特殊样式 */
  .layout-list .bookmark-grid > * {
    margin-bottom: 0.25rem !important;
    width: 100% !important;
  }

  /* 列表布局中的书签卡片样式调整 */
  .layout-list .bookmark-card {
    margin-bottom: 0 !important;
  }

  /* 列表布局中添加分隔线效果 */
  .layout-list .bookmark-grid > *:not(:last-child) {
    position: relative;
  }

  .layout-list .bookmark-grid > *:not(:last-child)::after {
    content: "";
    position: absolute;
    bottom: -0.125rem;
    left: 1.25rem;
    right: 1.25rem;
    height: 1px;
    background: linear-gradient(to right, transparent, hsl(var(--border) / 0.4), transparent);
  }

  /* 响应式优化：在小屏幕上调整间距和分隔线 */
  @media (max-width: 640px) {
    .layout-list .bookmark-grid > * {
      margin-bottom: 0.1875rem !important;
    }

    .layout-list .bookmark-grid > *:not(:last-child)::after {
      bottom: -0.09375rem;
      left: 1rem;
      right: 1rem;
    }
  }

  /* 书签卡片悬停效果 - 只在悬停单个书签时显示按钮和改变标题颜色 */
  .bookmark-group:hover .bookmark-group-hover\:opacity-100 {
    opacity: 1;
  }

  .bookmark-group:hover .bookmark-group-hover\:text-primary {
    color: hsl(var(--primary));
  }

  /* 预览面板样式 */
  .bookmark-preview-panel {
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
  }

  /* 预览面板动画 */
  .bookmark-preview-enter {
    transform: translateX(100%);
  }

  .bookmark-preview-enter-active {
    transform: translateX(0);
    transition: transform 300ms ease-in-out;
  }

  .bookmark-preview-exit {
    transform: translateX(0);
  }

  .bookmark-preview-exit-active {
    transform: translateX(100%);
    transition: transform 300ms ease-in-out;
  }

  /* 内联编辑样式 */
  .inline-edit-input {
    background: transparent;
    border: 1px solid hsl(var(--primary));
    border-radius: 4px;
    outline: none;
    transition: all 0.2s ease;
  }

  .inline-edit-input:focus {
    box-shadow: 0 0 0 2px hsl(var(--primary) / 0.2);
  }

  /* 双击提示动画 */
  .editable-text:hover {
    background: hsl(var(--accent) / 0.5);
    border-radius: 4px;
    padding: 1px 4px;
    margin: -1px -4px;
  }
}

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 0 0% 3.9%;
    --card: 0 0% 100%;
    --card-foreground: 0 0% 3.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 3.9%;
    --primary: 221.2 83.2% 53.3%;
    --primary-foreground: 0 0% 98%;
    --secondary: 0 0% 96.1%;
    --secondary-foreground: 0 0% 9%;
    --muted: 0 0% 96.1%;
    --muted-foreground: 0 0% 45.1%;
    --accent: 0 0% 96.1%;
    --accent-foreground: 0 0% 9%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;
    --border: 0 0% 89.8%;
    --input: 0 0% 89.8%;
    --ring: 0 0% 3.9%;
    --chart-1: 12 76% 61%;
    --chart-2: 173 58% 39%;
    --chart-3: 197 37% 24%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;
    --radius: 0.5rem;
    --sidebar-background: 0 0% 98%;
    --sidebar-foreground: 240 5.3% 26.1%;
    --sidebar-primary: 240 5.9% 10%;
    --sidebar-primary-foreground: 0 0% 98%;
    --sidebar-accent: 240 4.8% 95.9%;
    --sidebar-accent-foreground: 240 5.9% 10%;
    --sidebar-border: 220 13% 91%;
    --sidebar-ring: 217.2 91.2% 59.8%;
  }
  .dark {
    --background: 0 0% 3.9%;
    --foreground: 0 0% 98%;
    --card: 0 0% 3.9%;
    --card-foreground: 0 0% 98%;
    --popover: 0 0% 3.9%;
    --popover-foreground: 0 0% 98%;
    --primary: 0 0% 98%;
    --primary-foreground: 0 0% 9%;
    --secondary: 0 0% 14.9%;
    --secondary-foreground: 0 0% 98%;
    --muted: 0 0% 14.9%;
    --muted-foreground: 0 0% 63.9%;
    --accent: 0 0% 14.9%;
    --accent-foreground: 0 0% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;
    --border: 0 0% 14.9%;
    --input: 0 0% 14.9%;
    --ring: 0 0% 83.1%;
    --chart-1: 220 70% 50%;
    --chart-2: 160 60% 45%;
    --chart-3: 30 80% 55%;
    --chart-4: 280 65% 60%;
    --chart-5: 340 75% 55%;
    --sidebar-background: 240 5.9% 10%;
    --sidebar-foreground: 240 4.8% 95.9%;
    --sidebar-primary: 224.3 76.3% 48%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 240 3.7% 15.9%;
    --sidebar-accent-foreground: 240 4.8% 95.9%;
    --sidebar-border: 240 3.7% 15.9%;
    --sidebar-ring: 217.2 91.2% 59.8%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
}
