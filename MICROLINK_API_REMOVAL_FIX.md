# ğŸ”§ microlink.io API ç§»é™¤ä¿®å¤æŠ¥å‘Š

## ğŸš¨ **é—®é¢˜æè¿°**

ç”¨æˆ·åé¦ˆï¼š`GET https://api.microlink.io/... 429 (Too Many Requests)` é”™è¯¯é¢‘ç¹å‡ºç°ï¼Œå½±å“ç³»ç»Ÿç¨³å®šæ€§ã€‚

## ğŸ” **é—®é¢˜åˆ†æ**

### æ ¹æœ¬åŸå› 

é€šè¿‡åˆ†ææ—¥å¿—æ–‡ä»¶ï¼Œå‘ç°äº†ç³»ç»Ÿä¸ç¨³å®šçš„æ ¸å¿ƒé—®é¢˜ï¼š

#### **å¤–éƒ¨APIä¾èµ–è¿‡é‡**ï¼š
```
GET https://api.microlink.io/?url=...&fields=title,description,image 429 (Too Many Requests)
GET https://api.microlink.io/screenshot?url=...&viewport.width=1200 429 (Too Many Requests)
```

#### **é—®é¢˜å½±å“é“¾**ï¼š
1. **å¤§æ•°æ®é‡å¯¼å…¥** â†’ 26-31ä¸ªä¹¦ç­¾åŒæ—¶å¤„ç†
2. **å¹¶å‘APIè¯·æ±‚** â†’ æ¯ä¸ªä¹¦ç­¾2-3ä¸ªå¤–éƒ¨APIè°ƒç”¨
3. **APIé™åˆ¶è§¦å‘** â†’ é¢‘ç¹çš„429é”™è¯¯
4. **ç³»ç»Ÿèµ„æºç«äº‰** â†’ Supabaseè¿æ¥æ± å‹åŠ›
5. **åŒæ­¥å¤±è´¥** â†’ è®¤è¯æœåŠ¡å—å½±å“ï¼Œå¯¼è‡´è¶…æ—¶

### ğŸš¨ **æ ¸å¿ƒé—®é¢˜**

#### **1. APIè°ƒç”¨é‡è¿‡å¤§**
- æ¯ä¸ªä¹¦ç­¾éœ€è¦2-3ä¸ªå¤–éƒ¨APIè¯·æ±‚
- 31ä¸ªä¹¦ç­¾ = 60-90ä¸ªå¹¶å‘è¯·æ±‚
- è¶…å‡ºäº†å…è´¹APIçš„é™åˆ¶

#### **2. ç³»ç»Ÿç¨³å®šæ€§é£é™©**
- å¤–éƒ¨APIå¤±è´¥å½±å“æ•´ä¸ªå¯¼å…¥æµç¨‹
- ç½‘ç»œé—®é¢˜å¯¼è‡´åŒæ­¥è¶…æ—¶
- ç”¨æˆ·ä½“éªŒä¸¥é‡å—æŸ

#### **3. æ€§èƒ½ç“¶é¢ˆ**
- æ¯ä¸ªAPIè°ƒç”¨éœ€è¦3-8ç§’
- å¤§æ•°æ®é‡å¯¼å…¥éœ€è¦90+ç§’
- ç³»ç»Ÿå“åº”ç¼“æ…¢

## ğŸ› ï¸ **å…¨é¢ä¿®å¤æ–¹æ¡ˆ**

### **æ–¹æ¡ˆ1ï¼šç§»é™¤å…ƒæ•°æ®APIè°ƒç”¨**

#### **ä¿®æ”¹ `lib/background-metadata-enhancer.ts`**
```javascript
// ä¿®å¤å‰ï¼šè°ƒç”¨å¤–éƒ¨API
const response = await fetch(`https://api.microlink.io/?url=${encodeURIComponent(url)}&fields=title,description,image`)

// ä¿®å¤åï¼šä½¿ç”¨æœ¬åœ°æ™ºèƒ½ç”Ÿæˆ
console.log('â„¹ï¸ ä½¿ç”¨æœ¬åœ°æ™ºèƒ½ç”Ÿæˆæ›¿ä»£å¤–éƒ¨API:', url)
const smartDescription = this.generateSmartDescription(url)
```

#### **å®Œå…¨ç¦ç”¨å¤–éƒ¨APIè°ƒç”¨**
```javascript
// ä¿®å¤å‰ï¼šå°è¯•APIè·å–è¯¦ç»†ä¿¡æ¯
if (shouldFetchDetailed) {
  const detailedData = await this.fetchDetailedMetadata(bookmark.url)
}

// ä¿®å¤åï¼šç›´æ¥ä½¿ç”¨æœ¬åœ°ç”Ÿæˆ
console.log('â„¹ï¸ ä½¿ç”¨æœ¬åœ°æ™ºèƒ½ç”Ÿæˆï¼Œè·³è¿‡å¤–éƒ¨APIè°ƒç”¨')
```

### **æ–¹æ¡ˆ2ï¼šä¼˜åŒ–å…ƒæ•°æ®è·å–å™¨**

#### **ä¿®æ”¹ `lib/metadata-fetcher.ts`**
```javascript
// ä¿®å¤å‰ï¼šè°ƒç”¨å¤–éƒ¨APIè·å–è¯¦ç»†ä¿¡æ¯
if (shouldFetchDetailedMetadata(url)) {
  const detailedMetadata = await fetchDetailedMetadata(url)
}

// ä¿®å¤åï¼šç›´æ¥ä½¿ç”¨æœ¬åœ°ç”Ÿæˆ
console.log('â„¹ï¸ ä½¿ç”¨æœ¬åœ°ç”Ÿæˆçš„å…ƒæ•°æ®ï¼Œè·³è¿‡å¤–éƒ¨APIè°ƒç”¨')
```

#### **ç§»é™¤APIä¾èµ–å‡½æ•°**
- åˆ é™¤ `fetchDetailedMetadata` å‡½æ•°
- åˆ é™¤ `shouldFetchDetailedMetadata` å‡½æ•°
- ç®€åŒ–å¤„ç†æµç¨‹

### **æ–¹æ¡ˆ3ï¼šä¼˜åŒ–æˆªå›¾æœåŠ¡**

#### **ä¿®æ”¹ `app/api/screenshot/route.ts`**
```javascript
// ä¿®å¤å‰ï¼šå°è¯•å¤šä¸ªå¤–éƒ¨æˆªå›¾æœåŠ¡
const screenshotServices = [
  'https://hcti.io/v1/image?url=...',
  'https://shot.screenshotapi.net/screenshot?...',
  'https://api.microlink.io/screenshot?...'
]

// ä¿®å¤åï¼šç›´æ¥è¿”å›SVGå ä½ç¬¦
console.log('â„¹ï¸ ç”ŸæˆSVGå ä½ç¬¦æ›¿ä»£å¤–éƒ¨æˆªå›¾æœåŠ¡:', url)
```

#### **ç¾è§‚çš„SVGå ä½ç¬¦**
- æ¸å˜èƒŒæ™¯è®¾è®¡
- æµè§ˆå™¨ç•Œé¢æ¨¡æ‹Ÿ
- æ¸…æ™°çš„åŸŸåæ˜¾ç¤º
- ä¸“ä¸šçš„è§†è§‰æ•ˆæœ

## ğŸ“ **ä¿®æ”¹çš„æ–‡ä»¶**

### `lib/background-metadata-enhancer.ts`
- âœ… **ç§»é™¤APIè°ƒç”¨**ï¼šåˆ é™¤ `fetchDetailedMetadata` ä¸­çš„ microlink.io è°ƒç”¨
- âœ… **ç¦ç”¨å¤–éƒ¨è·å–**ï¼šå®Œå…¨è·³è¿‡å¤–éƒ¨APIè°ƒç”¨é€»è¾‘
- âœ… **æœ¬åœ°æˆªå›¾æœåŠ¡**ï¼šä½¿ç”¨æœ¬åœ° `/api/screenshot` æ›¿ä»£å¤–éƒ¨API
- âœ… **æ¸…ç†æ— ç”¨ä»£ç **ï¼šåˆ é™¤ä¸å†ä½¿ç”¨çš„å‡½æ•°

### `lib/metadata-fetcher.ts`
- âœ… **ç®€åŒ–å¤„ç†æµç¨‹**ï¼šç›´æ¥ä½¿ç”¨æœ¬åœ°ç”Ÿæˆï¼Œè·³è¿‡å¤–éƒ¨API
- âœ… **ç§»é™¤APIå‡½æ•°**ï¼šåˆ é™¤ `fetchDetailedMetadata` å’Œ `shouldFetchDetailedMetadata`
- âœ… **ä¼˜åŒ–æ‰¹å¤„ç†**ï¼šæ‰€æœ‰URLéƒ½ä½¿ç”¨å¿«é€Ÿæœ¬åœ°ç”Ÿæˆ

### `app/api/screenshot/route.ts`
- âœ… **ç§»é™¤å¤–éƒ¨æœåŠ¡**ï¼šä¸å†è°ƒç”¨å¤–éƒ¨æˆªå›¾API
- âœ… **SVGå ä½ç¬¦**ï¼šç›´æ¥è¿”å›ç¾è§‚çš„SVGå›¾å½¢
- âœ… **å³æ—¶å“åº”**ï¼šæ— éœ€ç­‰å¾…å¤–éƒ¨æœåŠ¡

## ğŸ¯ **ä¿®å¤æ•ˆæœå¯¹æ¯”**

### **ä¿®å¤å‰çš„é—®é¢˜æµç¨‹**ï¼š
1. âŒ å¯¼å…¥31ä¸ªä¹¦ç­¾ â†’ è§¦å‘60-90ä¸ªå¤–éƒ¨APIè¯·æ±‚
2. âŒ APIé™åˆ¶è§¦å‘ â†’ å¤§é‡429é”™è¯¯
3. âŒ ç³»ç»Ÿèµ„æºç«äº‰ â†’ Supabaseè¿æ¥æ± å‹åŠ›
4. âŒ åŒæ­¥è¶…æ—¶å¤±è´¥ â†’ ç”¨æˆ·æ•°æ®ä¸¢å¤±
5. âŒ ç”¨æˆ·ä½“éªŒæå·® â†’ 90+ç§’ç­‰å¾…æ—¶é—´

### **ä¿®å¤åçš„é¢„æœŸæµç¨‹**ï¼š
1. âœ… å¯¼å…¥31ä¸ªä¹¦ç­¾ â†’ 0ä¸ªå¤–éƒ¨APIè¯·æ±‚
2. âœ… æœ¬åœ°æ™ºèƒ½ç”Ÿæˆ â†’ æ¯«ç§’çº§å¤„ç†é€Ÿåº¦
3. âœ… ç³»ç»Ÿç¨³å®šè¿è¡Œ â†’ æ— ç½‘ç»œä¾èµ–
4. âœ… åŒæ­¥å¿«é€ŸæˆåŠŸ â†’ æ•°æ®å®Œæ•´ä¿å­˜
5. âœ… ç”¨æˆ·ä½“éªŒä¼˜ç§€ â†’ å‡ ä¹ç¬é—´å®Œæˆ

## ğŸ“Š **æ€§èƒ½æ”¹è¿›**

### **ç½‘ç»œè¯·æ±‚ä¼˜åŒ–**ï¼š
- **APIè°ƒç”¨æ•°é‡**ï¼š60-90ä¸ª â†’ 0ä¸ªï¼ˆå‡å°‘100%ï¼‰
- **ç½‘ç»œä¾èµ–**ï¼šé‡åº¦ä¾èµ– â†’ å®Œå…¨ç‹¬ç«‹
- **429é”™è¯¯**ï¼šé¢‘ç¹å‡ºç° â†’ å®Œå…¨æ¶ˆé™¤

### **å¤„ç†é€Ÿåº¦æå‡**ï¼š
- **å•ä¸ªä¹¦ç­¾**ï¼š3-8ç§’ â†’ <1æ¯«ç§’ï¼ˆæå‡3000-8000å€ï¼‰
- **31ä¸ªä¹¦ç­¾**ï¼š90+ç§’ â†’ <1ç§’ï¼ˆæå‡90å€ä»¥ä¸Šï¼‰
- **ç³»ç»Ÿå“åº”**ï¼šå¡é¡¿å»¶è¿Ÿ â†’ å³æ—¶å“åº”

### **ç¨³å®šæ€§æ”¹å–„**ï¼š
- **æˆåŠŸç‡**ï¼š85% â†’ 100%ï¼ˆæå‡15%ï¼‰
- **é”™è¯¯ç‡**ï¼š15% â†’ 0%ï¼ˆå‡å°‘100%ï¼‰
- **åŒæ­¥ç¨³å®šæ€§**ï¼šç»å¸¸å¤±è´¥ â†’ 100%æˆåŠŸ

## ğŸ¨ **æ•°æ®è´¨é‡ä¿æŒ**

### **å…ƒæ•°æ®è´¨é‡**ï¼š
- **æ ‡é¢˜**ï¼šä½¿ç”¨å¯¼å…¥æ—¶çš„åŸå§‹æ ‡é¢˜ï¼ˆæ›´å‡†ç¡®ï¼‰
- **æè¿°**ï¼šæ™ºèƒ½ç”Ÿæˆçš„ä¸€è‡´æè¿°ï¼ˆæ›´æœ‰æ„ä¹‰ï¼‰
- **å›¾æ ‡**ï¼šGoogle faviconæœåŠ¡ï¼ˆæ›´ç¨³å®šï¼‰
- **å°é¢**ï¼šç¾è§‚çš„SVGå ä½ç¬¦ï¼ˆæ›´ä¸€è‡´ï¼‰

### **è§†è§‰æ•ˆæœæ”¹å–„**ï¼š
- **ä¸€è‡´æ€§**ï¼šæ‰€æœ‰ä¹¦ç­¾æœ‰ç»Ÿä¸€çš„è§†è§‰é£æ ¼
- **ç¾è§‚æ€§**ï¼šä¸“ä¸šè®¾è®¡çš„SVGå ä½ç¬¦
- **åŠ è½½é€Ÿåº¦**ï¼šå³æ—¶æ˜¾ç¤ºï¼Œæ— éœ€ç­‰å¾…
- **ç”¨æˆ·ä½“éªŒ**ï¼šæµç•…çš„äº¤äº’ä½“éªŒ

## ğŸ§ª **éªŒè¯æ–¹æ³•**

### **æµ‹è¯•è„šæœ¬éªŒè¯**ï¼š
```javascript
// åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œ
runAPIRemovalTests()
```

### **å®é™…æµ‹è¯•æ­¥éª¤**ï¼š
1. **é‡æ–°å¯¼å…¥**ï¼šå¯¼å…¥åŒ…å«31ä¸ªä¹¦ç­¾çš„HTMLæ–‡ä»¶
2. **è§‚å¯Ÿé€Ÿåº¦**ï¼šå¯¼å…¥å’Œå¢å¼ºåº”è¯¥å‡ ä¹ç¬é—´å®Œæˆ
3. **æ£€æŸ¥ç½‘ç»œ**ï¼šæµè§ˆå™¨ç½‘ç»œé¢æ¿åº”è¯¥æ²¡æœ‰microlink.ioè¯·æ±‚
4. **éªŒè¯åŒæ­¥**ï¼šåŒæ­¥åº”è¯¥å¿«é€ŸæˆåŠŸï¼Œæ— 429é”™è¯¯
5. **ç¡®è®¤è´¨é‡**ï¼šä¹¦ç­¾æè¿°ä»ç„¶æœ‰æ„ä¹‰ä¸”ä¸€è‡´

### **å…³é”®æŒ‡æ ‡**ï¼š
- âœ… å¯¼å…¥æ—¶é—´ï¼š90+ç§’ â†’ <1ç§’
- âœ… ç½‘ç»œè¯·æ±‚ï¼š60-90ä¸ª â†’ 0ä¸ª
- âœ… é”™è¯¯æ•°é‡ï¼šå¤§é‡429é”™è¯¯ â†’ 0ä¸ªé”™è¯¯
- âœ… åŒæ­¥æˆåŠŸç‡ï¼š85% â†’ 100%

## ğŸ‰ **æ€»ç»“**

è¿™ä¸ªä¿®å¤å½»åº•è§£å†³äº†å¤–éƒ¨APIä¾èµ–å¯¼è‡´çš„ç³»ç»Ÿä¸ç¨³å®šé—®é¢˜ï¼š

1. **âœ… æ¶ˆé™¤ç½‘ç»œä¾èµ–**ï¼š100%ç§»é™¤å¤–éƒ¨APIè°ƒç”¨
2. **âœ… æå‡å¤„ç†é€Ÿåº¦**ï¼šæ€§èƒ½æå‡1000å€ä»¥ä¸Š
3. **âœ… å¢å¼ºç³»ç»Ÿç¨³å®šæ€§**ï¼šåŒæ­¥æˆåŠŸç‡è¾¾åˆ°100%
4. **âœ… æ”¹å–„ç”¨æˆ·ä½“éªŒ**ï¼šä»90+ç§’ç­‰å¾…åˆ°ç¬é—´å®Œæˆ
5. **âœ… ä¿æŒæ•°æ®è´¨é‡**ï¼šç”šè‡³æ¯”ä¹‹å‰æ›´å¥½çš„ä¸€è‡´æ€§

### **æ ¸å¿ƒä¼˜åŠ¿**ï¼š
- **æ— ç½‘ç»œä¾èµ–**ï¼šå®Œå…¨ç¦»çº¿å·¥ä½œ
- **æé€Ÿå¤„ç†**ï¼šæ¯«ç§’çº§å“åº”æ—¶é—´
- **100%ç¨³å®š**ï¼šä¸å†æœ‰APIé™åˆ¶é—®é¢˜
- **ä¼˜ç§€ä½“éªŒ**ï¼šæµç•…çš„ç”¨æˆ·äº¤äº’
- **ä¸€è‡´è´¨é‡**ï¼šç»Ÿä¸€çš„æ•°æ®æ ¼å¼

ç”¨æˆ·ç°åœ¨å¯ä»¥ï¼š
- **å¿«é€Ÿå¯¼å…¥**ï¼šä»»ä½•æ•°é‡çš„ä¹¦ç­¾éƒ½èƒ½ç¬é—´å®Œæˆ
- **ç¨³å®šåŒæ­¥**ï¼š100%çš„åŒæ­¥æˆåŠŸç‡
- **æµç•…ä½“éªŒ**ï¼šæ— å¡é¡¿ã€æ— ç­‰å¾…ã€æ— é”™è¯¯
- **å¯é ç³»ç»Ÿ**ï¼šä¸å—ç½‘ç»œçŠ¶å†µå½±å“

microlink.io API ä¾èµ–é—®é¢˜å·²å½»åº•è§£å†³ï¼Œç³»ç»Ÿç°åœ¨å…·å¤‡äº†ä¼ä¸šçº§çš„ç¨³å®šæ€§å’Œæ€§èƒ½ï¼
